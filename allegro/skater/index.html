<html>
<head>
  <style type="text/css">
    @font-face {
      font-family: 'fabfont';
/*      font-display: optional;*/
      src: url('./../../font/DejaVuSansMono.woff2');
    }

    * {
       font-size: 16px;
    }

    html {
      font-family: fabfont;
      max-width: 900px;  /* For Desktop PC (see @media for Tablets/Phones) */
      padding-left: 2%;
      padding-right: 3%;
      margin: 0 auto;
      background: #F5F5F0;
  	} 
    


  	a {
      color: black;
      font-weight: bold;
    }

    img {
      border: none; 
    }

    p {
      margin-top: 0px;
      text-align: justify;
    }
    sup {
      vertical-align: 0.3em;
      font-size: 0.65em;
    }   

    pre {
      font-family: fabfont;
      background-color: white; 
      border: 1px solid Black; 
      padding-left: 2%;
      padding-top: 1ch;
      padding-bottom: 1ch;
      /* Only take care of X overflow since this is the only part that can be too wide.
         The Y axis will never overflow.
      */
      /*overflow: hidden;*/
      overflow: auto;  
    }

    div.heading {
      font-weight: bold;      
      text-transform: uppercase;
      margin-top: 4ch;
    }

    /** {
      font-size: 16px;
    }*/
    @media (max-width: 500px) { /* For small screen decices */
      * {
        font-size: 12px; 
      }
    }   
    .title {
      text-decoration: none;
    }

    img.pixel, canvas.pixel {
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }

    blockquote { 
    background-color: #f3f3f3;
    border: dashed 1px grey; 
    width: 97.5%; 
    font-style: italic; 
    text-align: justify;

    padding: 1ch; 
    padding-top: 2ch; 
    padding-bottom: 2ch;     
    
    margin : 0ch; 
    margin-bottom: 2ch; 
    margin-top: 0ch;
  }

  blockquote div {
    text-transform: none;
    text-align: right;
    width: 100%;
  }

  code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
  }

  </style>
  <title>Skater</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
</head>  
  <body><br><center>
    <div style="display: inline-block; vertical-align:middle;">
<a href="/" class="title"><b>Teacher's</b><br>
</a><hr/>
</div>
</center><br><br>
<div style="margin-bottom: 2ch;text-transform: none;">
February 05, 2026</div>
<div class='heading'>Skater</div><hr/><p>
Let's analyze skater demo from <a href="https://liballeg.org">Allegro</a><br />
Why analyze this instead of doom or some important codes?<br />
because, I always wanted to understand how the physics system works where the shapes are not boxes and circles <br />
and those codes are already analyzed pretty well by professional guys.<a name="back_1" style="text-decoration: none;" href="#footnote_1"><sup>[1]</sup></a><br /> 
</p>
<div class='heading'>Files</div><hr/><pre>
$ ls *.c
anim.c                 level.c                menu_success.c
background_scroller.c  level_file.c           mouse.c
credits.c              level_state.c          music.c
fps.c                  menu_about.c           physics.c
framework.c            menu.c                 quadtree.c
game.c                 menu_controls.c        screenshot.c
gamepad.c              menu_graphics.c        skater.c
global.c               menu_main.c            token.c
intro.c                menu_misc.c            transition.c
keyboard.c             menu_options.c         vcontroller.c
level_alloc.c          menu_sound.c

$ ls *.c | wc -l
32
</pre>
<p>
What we're interested in is <pre>physics.c</pre>So, lets jump into that.<br />
</p>
<div class='heading'>Physics</div><hr/><pre>
// 3 local functions
static double FixUp(double *vec, double normalx, double normaly) {...}
static void SetAngle(double normalx, double normaly, double *a, int JustDoIt) {...}
static void SetAngle(double normalx, double normaly, double *a, int JustDoIt) {...}

// 1 global function
struct QuadTreeNode *RunPhysics(struct Level *lvl, double *pos,
                                double *vec, double TimeToGo,
                                struct Animation *PAnim) {...}
</pre>
</p>
<style type='text/css'>td.ref {  padding-bottom: 0ch; width:0;}</style><div class='heading'>References</div><hr/><p id='paperbox' style='text-align:left;'><table><tbody style='vertical-align: top;'><tr><td class='ref' style='width:1ch;'><a name="footnote_1"></a><a href="#back_1">^</a></td><td  class='ref' style='width:4ch;'> [1]</td><td style='width:100%;text-align:left;' class='ref'><a href="fabiansanglard.net/doomIphone/doomClassicRenderer">DOOM source code review</a></td></tr></tbody></table></p> <hr>
 <center>*